<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:repeat value="#{activePlants.activeResource}" var="activeResource"
		varStatus="status">
		<c:set var="currentPowerPlant"
			value="#{activePlants.plants.get(status.index)}"></c:set>
		<h3 class="plant-card-title">
			<h:outputFormat value="#{msg.powerPlantTitle}">
				<f:param value="#{status.index+3}" />
			</h:outputFormat>
		</h3>

		<div>
			<h:form>
				<h:outputFormat value="#{msg.powerPlantAvailableResources}">
					<f:param value="#{currentPowerPlant.energyResources}" />
				</h:outputFormat>
				<br />
				<h:panelGroup rendered="#{plantStocker.canStockPlant(currentPowerPlant)}">
					<h:outputFormat value="#{msg.inputAvailableResources}">
						<f:param value="#{status.index+3}" />
					</h:outputFormat>

					<h:inputText id="inputAvailableResources"
						value="#{activeResource.availableResources}"
						validator="#{activePlants.plantStorageValidator(currentPowerPlant).availableResourcesValidator}"
						validatorMessage="#{msg.plantOverStocked}" />
					<h:message for="inputAvailableResources" />

					<h:commandButton value="#{msg.add}">
						<f:ajax event="click" execute="@form" render="@form"
							listener="#{activePlants.updatePowerPlantResources(status.index)}" />
					</h:commandButton>

					<h:selectOneMenu value="#{resources.chosenResourceType}">
						<f:selectItems
							value="#{resources.getFilteredResourceTypes(currentPowerPlant)}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:commandButton value="#{msg.powerThePlant}"
					rendered="#{plantFirer.canFirePlant(currentPowerPlant)}">
					<f:ajax event="click" render="@form"
						listener="#{plantFirer.firePlant(currentPowerPlant)}" />
				</h:commandButton>
			</h:form>
		</div>

	</ui:repeat>

</ui:composition>